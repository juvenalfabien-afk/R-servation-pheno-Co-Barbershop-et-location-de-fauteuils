<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>PHENO&CO ‚Äî R√©servation de fauteuil</title>
<meta name="color-scheme" content="dark light">
<style>
  :root{
    --bg:#0b0b0b; --card:#111; --line:#1f1f1f;
    --fg:#f7f7f7; --muted:#bdbdbd;
    --yellow:#ffd400; --grey:#2d3138; --green:#25D366; --focus:#8ab4f8;
    --radius:20px;
  }
  *{box-sizing:border-box}
  html{scroll-behavior:smooth}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--fg)}
  .wrap{max-width:980px;margin:0 auto;padding:28px 18px 64px}
  header{text-align:center;margin-bottom:8px}
  img.logo{width:260px;max-width:50vw;height:auto;border-radius:12px}
  h1{margin:8px 0 6px;font-size:40px;color:var(--yellow)}
  .sub{margin:0 0 26px;color:var(--muted);text-align:center}
  .grid{display:grid;gap:14px;margin:0 auto 28px;grid-template-columns:1fr}
  @media(min-width:720px){.grid{grid-template-columns:repeat(3,1fr)}}
  .btn{display:block;padding:18px 20px;border-radius:var(--radius);text-decoration:none;font-weight:800;text-align:center;line-height:1.2;box-shadow:0 1px 0 rgba(255,255,255,.06) inset,0 12px 28px rgba(0,0,0,.35);transition:.15s}
  .btn:focus-visible{outline:3px solid var(--focus);outline-offset:2px}
  .btn:active{transform:translateY(1px)}
  .btn-yellow{background:var(--yellow);color:#000}
  .btn-grey{background:var(--grey);color:#fff;border:2px solid #464b54}
  .btn-green{background:var(--green);color:#000}

  section.card{background:var(--card);border:1px solid var(--line);border-radius:24px;padding:22px;margin-top:36px}
  h2{margin:0 0 10px;color:var(--yellow)}
  p.lead{margin:8px 0 18px;color:var(--muted)}
  label{display:block;margin:10px 0 6px}
  input,select,textarea{width:100%;padding:12px;border-radius:12px;border:1px solid #2a2a2a;background:#121212;color:#fff;font-size:16px}
  input[type="date"]{padding:10px 12px;cursor:pointer}
  select{cursor:pointer}
  textarea{min-height:96px;resize:vertical}
  .row{display:grid;gap:12px}
  @media(min-width:680px){.row{grid-template-columns:1fr 1fr}}

  .section-title{font-weight:900;color:#fff;margin:12px 0 6px}
  .section-title .accent{color:#000;background:var(--yellow);padding:2px 8px;border-radius:8px;margin-left:8px}

  .prices-hint{margin-top:6px;color:#000;background:var(--yellow);display:inline-block;padding:4px 10px;border-radius:999px;font-weight:900}

  .actions{display:flex;gap:12px;margin-top:16px;flex-wrap:wrap}
  .btn-submit,.btn-reset{flex:1;min-width:160px;padding:14px 16px;border-radius:14px;border:none;font-weight:800;cursor:pointer}
  .btn-submit{background:var(--yellow);color:#000}
  .btn-reset{background:var(--grey);color:#fff}

  .summary{border-top:1px dashed #2b2b2b;margin-top:16px;padding-top:12px;color:#e6e6e6}
  .summary small{color:var(--muted)}
  ul.packs{list-style:none;padding:0;margin:0;display:grid;gap:8px}
  ul.packs li{display:flex;align-items:center;gap:10px}
  .note{color:#9aa0a6;font-size:12px}
  footer{margin-top:40px;color:#999;text-align:center;font-size:12px}

  /* Modal CGV */
  .modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;padding:18px}
  .modal .box{max-width:900px;width:100%;background:#0f0f0f;border:1px solid #222;border-radius:18px;padding:18px;max-height:85vh;overflow:auto}
  .modal .box h3{margin:0 0 10px;color:var(--yellow)}
  .close{display:inline-block;margin-top:10px;padding:10px 14px;background:#222;border:1px solid #333;border-radius:10px;color:#fff;text-decoration:none}
  .contract h4{margin:14px 0 8px}
  .contract p, .contract li{color:#ddd}
  .contract ul{margin:0 0 8px 18px}
  @media(prefers-reduced-motion:reduce){html{scroll-behavior:auto}.btn{transition:none}}
</style>
</head>
<body>
<main class="wrap">
  <header>
    <img class="logo" src="logo.png" alt="Logo PHENO&CO" onerror="this.style.display='none'">
    <h1>PHENO&CO</h1>
    <p class="sub">Barbershop ‚Ä¢ Depuis 2009 ‚Ä¢ 18 Rue d'Alger, 34000 Montpellier</p>
  </header>

  <!-- 3 boutons -->
  <div class="grid" role="navigation" aria-label="Actions principales">
    <a class="btn btn-yellow" href="#fauteuil">R√©server Fauteuil üí∫</a>
    <a class="btn btn-grey" href="https://phenoandco.com" target="_blank" rel="noopener">Prendre RDV Coiffure üíà</a>
    <a class="btn btn-green" href="https://wa.me/33769432605?text=Bonjour%20PHENO%26CO%20!" target="_blank" rel="noopener">Contact WhatsApp</a>
  </div>

  <!-- Formulaire -->
  <section id="fauteuil" class="card" aria-labelledby="title-fauteuil">
    <h2 id="title-fauteuil">R√©server un fauteuil</h2>
    <p class="lead">Calendriers cliquables, heures en liste, **formules visibles avec tarifs** en jaune, packs petit mat√©riel en location. Total auto (HT, TVA 20%, TTC, acompte 50%).</p>

    <form id="chairForm" autocomplete="on" novalidate>
      <!-- Identit√© -->
      <div class="row">
        <div>
          <label for="f-name">Nom et pr√©nom</label>
          <input id="f-name" name="name" required placeholder="Ex. Jean Dupont" />
        </div>
        <div>
          <label for="f-phone">T√©l√©phone</label>
          <input id="f-phone" name="phone" required inputmode="tel" placeholder="Ex. 06 12 34 56 78" />
        </div>
      </div>

      <!-- P√©riode -->
      <div class="row">
        <div>
          <label for="f-start-date">Date de d√©but</label>
          <input id="f-start-date" type="date" name="startDate" required />
        </div>
        <div>
          <label for="f-start-time">Heure d‚Äôarriv√©e (10:00‚Äì18:00)</label>
          <select id="f-start-time" name="startTime" required></select>
        </div>
      </div>
      <div class="row">
        <div>
          <label for="f-end-date">Date de fin</label>
          <input id="f-end-date" type="date" name="endDate" required />
        </div>
        <div>
          <label for="f-hours-per-day">Heures par jour</label>
          <select id="f-hours-per-day" name="hoursPerDay" required></select>
          <div class="note">Ex. 4h = 10:00 ‚Üí 14:00</div>
        </div>
      </div>

      <!-- Formule (menu d√©roulant avec tarifs visibles) -->
      <div class="section-title">Formule <span class="accent">tarifs</span></div>
      <label for="f-formula">Choisir une formule (tarifs HT affich√©s)</label>
      <select id="f-formula" name="formula" required></select>
      <div class="prices-hint" id="formulaHint">‚Äî</div>

      <!-- Packs petit mat√©riel en location -->
      <div class="section-title">Packs petit mat√©riel <span class="accent">en location</span></div>
      <ul class="packs" id="packsList"></ul>

      <!-- Note -->
      <label for="f-note">Message (optionnel)</label>
      <textarea id="f-note" name="note" placeholder="Ex. Poste miroir 2, st√©rilisateur, horaires 10h‚Äì14h‚Ä¶"></textarea>

      <!-- CGV -->
      <label style="display:flex;align-items:center;gap:8px;margin-top:14px">
        <input type="checkbox" id="f-cgv" required>
        <span>J‚Äôai lu et j‚Äôaccepte les <a href="#" id="openCgv" style="color:#8ab4f8">CGV & contrat</a> personnalis√©s.</span>
      </label>

      <!-- R√©sum√© -->
      <div class="summary" id="summary">
        <div><small>P√©riode :</small> <span id="sum-period">‚Äî</span></div>
        <div><small>Jours compt√©s :</small> <span id="sum-days">0</span></div>
        <div><small>Heures/jour :</small> <span id="sum-hpd">0</span></div>
        <div><small>Dur√©e totale :</small> <span id="sum-hours">0 h</span></div>
        <div><small>Base HT :</small> <span id="sum-base">0 ‚Ç¨</span></div>
        <div><small>Packs HT :</small> <span id="sum-packs">0 ‚Ç¨</span></div>
        <div><small>Total HT :</small> <span id="sum-ht">0 ‚Ç¨</span></div>
        <div><small>TVA (20%) :</small> <span id="sum-tva">0 ‚Ç¨</span></div>
        <div><b>Total TTC :</b> <span id="sum-ttc">0 ‚Ç¨</span></div>
        <div><small>Acompte 50% :</small> <span id="sum-deposit">0 ‚Ç¨</span></div>
      </div>

      <!-- Actions -->
      <div class="actions">
        <button class="btn-submit" type="submit">Confirmer & envoyer (WhatsApp)</button>
        <button class="btn-reset" type="reset">Effacer</button>
        <a id="emailLink" class="btn btn-grey" href="#" target="_blank" rel="noopener">Envoyer aussi par e-mail</a>
      </div>
      <p id="helper" class="lead" style="display:none;margin-top:10px;">WhatsApp s‚Äôouvre. Si rien, v√©rifie le bloqueur de fen√™tres. Un e-mail brouillon est aussi pr√™t.</p>
    </form>

    <!-- CGV Modal (avec r√©cap dynamique) -->
    <div class="modal" id="cgvModal" aria-hidden="true">
      <div class="box" role="dialog" aria-modal="true" aria-labelledby="cgvTitle">
        <h3 id="cgvTitle">CGV & Contrat ‚Äî PHENO&CO</h3>
        <div class="contract">
          <h4>R√©capitulatif personnalis√©</h4>
          <ul>
            <li><b>P√©riode :</b> <span id="c_sum-period">‚Äî</span></li>
            <li><b>Heures/jour :</b> <span id="c_sum-hpd">‚Äî</span></li>
            <li><b>Formule :</b> <span id="c_sum-formula">‚Äî</span></li>
            <li><b>Packs HT :</b> <span id="c_sum-packs">‚Äî</span></li>
            <li><b>Total HT :</b> <span id="c_sum-ht">‚Äî</span></li>
            <li><b>TVA 20% :</b> <span id="c_sum-tva">‚Äî</span></li>
            <li><b>Total TTC :</b> <span id="c_sum-ttc">‚Äî</span></li>
            <li><b>Acompte 50% :</b> <span id="c_sum-deposit">‚Äî</span></li>
          </ul>

          <h4>Engagements du salon</h4>
          <ul>
            <li>Poste propre et fonctionnel aux horaires convenus (10:00‚Äì18:00).</li>
            <li>Normes d‚Äôhygi√®ne et de s√©curit√© respect√©es.</li>
            <li>Information en cas d‚Äôindisponibilit√© exceptionnelle.</li>
          </ul>

          <h4>Responsabilit√©s du locataire</h4>
          <ul>
            <li>Respect des horaires r√©serv√©s et de l‚Äôhygi√®ne du poste.</li>
            <li>Soin du mat√©riel ; d√©claration imm√©diate de tout dommage.</li>
            <li>Respect de la confidentialit√© clients et de la tranquillit√© du salon.</li>
          </ul>

          <h4>Mat√©riel & Caution</h4>
          <p>Packs petit mat√©riel en location au choix. Caution possible selon la valeur du mat√©riel.</p>

          <h4>Acompte & Paiement</h4>
          <p>Acompte de 50% du TTC √† la confirmation (lien s√©curis√© envoy√©). Solde √† l‚Äôarriv√©e.</p>

          <h4>Annulation</h4>
          <p>Conditions et d√©lais d‚Äôannulation communiqu√©s lors de la confirmation.</p>
        </div>
        <a href="#" class="close" id="closeCgv">Fermer</a>
      </div>
    </div>
  </section>

  <footer>¬© PHENO&CO ‚Äî Tous droits r√©serv√©s</footer>
</main>

<script>
/* ====== CONFIG TARIFS ====== */
const PHONE = '33769432605';
const EMAIL = 'location.phenoandco@gmail.com';
const OPEN_HOUR = 10, CLOSE_HOUR = 18;
const HOURLY_HT = 10;              // ‚Ç¨ HT / heure (modifiable)
const TVA_RATE = 0.20;

// D√©finition des formules avec le nombre d'heures par "bloc"
const FORMULAE = [
  { key:'hour',    label:'Horaire',         unitHours: 1  },  // facturation √† l‚Äôheure
  { key:'halfday', label:'Demi-journ√©e',    unitHours: 4  },  // 4h
  { key:'fullday', label:'Journ√©e',         unitHours: 8  },  // 8h
  { key:'week',    label:'Semaine',         unitHours: 40 },  // 5j x 8h
  { key:'month',   label:'Mois',            unitHours: 160}   // 4 semaines x 40h
];

// Packs petit mat√©riel en location
const PACKS = [
  { id:'tondeuse',  label:'Pack Tondeuse Pro', priceHt:5 },
  { id:'produits',  label:'Pack Produits',     priceHt:8 },
  { id:'serviettes',label:'Pack Serviettes',   priceHt:4 },
];

/* ===== Helpers ===== */
const ‚Ç¨  = new Intl.NumberFormat('fr-FR',{style:'currency',currency:'EUR'});
const id = s=>document.getElementById(s);
const q  =(s,root=document)=>root.querySelector(s);
const qa =(s,root=document)=>Array.from(root.querySelectorAll(s));
const clamp=(v,min,max)=>Math.max(min,Math.min(max,v));
function parseDate(d){ if(!d) return null; const [y,m,day]=d.split('-').map(Number); return new Date(y,m-1,day); }
function daysBetweenInclusive(sd, ed){
  if(!sd || !ed) return 0;
  const msDay = 86400000;
  const a = new Date(sd.getFullYear(), sd.getMonth(), sd.getDate());
  const b = new Date(ed.getFullYear(), ed.getMonth(), ed.getDate());
  return Math.floor((b - a)/msDay) + 1;
}

/* ===== Init heures & heures/jour ===== */
(function initTimeSelectors(){
  const sel = id('f-start-time');
  for(let h=OPEN_HOUR; h<=CLOSE_HOUR; h++){
    for(let m of [0,30]){
      if(h===CLOSE_HOUR && m>0) continue;
      const label = `${String(h).padStart(2,'0')}:${String(m).padStart(2,'0')}`;
      sel.appendChild(new Option(label,label));
    }
  }
  sel.value = `${String(OPEN_HOUR).padStart(2,'0')}:00`;

  const hpd = id('f-hours-per-day');
  for(let v=0.5; v<=8; v+=0.5){
    hpd.appendChild(new Option(v.toString().replace('.',',')+' h', v.toFixed(1)));
  }
  hpd.value='4.0';
})();

/* ===== Init dates (calendriers) ===== */
(function initDates(){
  const today=new Date();
  const s=[today.getFullYear(), String(today.getMonth()+1).padStart(2,'0'), String(today.getDate()).padStart(2,'0')].join('-');
  id('f-start-date').value=s; id('f-end-date').value=s;
  id('f-start-date').min=s;   id('f-end-date').min=s;
  // ouvrir le calendrier au focus/clic (si support√©)
  ['f-start-date','f-end-date'].forEach(fid=>{
    const el=id(fid);
    ['focus','click'].forEach(evt=>{
      el.addEventListener(evt, ()=>{ try{ el.showPicker && el.showPicker(); }catch(_){} });
    });
  });
})();

/* ===== Init formules (menu avec tarifs visibles) ===== */
(function initFormulaSelect(){
  const sel = id('f-formula');
  sel.appendChild(new Option('S√©lectionner‚Ä¶',''));
  FORMULAE.forEach(f=>{
    const price = HOURLY_HT * f.unitHours;
    const text  = `${f.label} ‚Äî ${f.unitHours}h = ${‚Ç¨.format(price)} HT`;
    sel.appendChild(new Option(text, f.key));
  });
  sel.addEventListener('change', updateAll);
  id('formulaHint').textContent = `Horaire: ${‚Ç¨.format(HOURLY_HT)}/h ‚Ä¢ 1/2j: ${‚Ç¨.format(4*HOURLY_HT)} ‚Ä¢ 1j: ${‚Ç¨.format(8*HOURLY_HT)} ‚Ä¢ 1 sem.: ${‚Ç¨.format(40*HOURLY_HT)} ‚Ä¢ 1 mois: ${‚Ç¨.format(160*HOURLY_HT)} (HT)`;
})();

/* ===== Init packs ===== */
(function initPacks(){
  const ul=id('packsList');
  PACKS.forEach(p=>{
    const li=document.createElement('li');
    li.innerHTML=`<label style="cursor:pointer"><input type="checkbox" name="packs" value="${p.priceHt}"> ${p.label} ‚Äî <span style="opacity:.8">${‚Ç¨.format(p.priceHt)} HT</span></label>`;
    ul.appendChild(li);
  });
  qa('input[name="packs"]').forEach(c=>c.addEventListener('change', updateAll));
})();

/* ===== Calcul ===== */
function sumPacks(){ return qa('input[name="packs"]:checked').reduce((s,el)=>s+Number(el.value),0); }
function selectedFormulaKey(){ return id('f-formula').value || null; }
function selectedFormulaObj(){ const k=selectedFormulaKey(); return FORMULAE.find(f=>f.key===k)||null; }

function compute(){
  const sd = parseDate(id('f-start-date').value);
  const ed = parseDate(id('f-end-date').value);
  const st = id('f-start-time').value;
  const hpd = clamp(parseFloat(id('f-hours-per-day').value||'0'), 0.5, 8);
  const days = daysBetweenInclusive(sd, ed);
  const fObj = selectedFormulaObj();

  const totalRequestedHours = (days>0 ? days : 0) * hpd;

  let baseHours = 0;
  if(fObj){
    const unit=fObj.unitHours;
    baseHours = (fObj.key==='hour') ? totalRequestedHours : Math.ceil(totalRequestedHours/unit)*unit;
  }
  const baseHt = baseHours * HOURLY_HT;
  const packsHt = sumPacks();
  const totalHt = Math.max(0, baseHt + packsHt);
  const tva = totalHt * TVA_RATE;
  const ttc = totalHt + tva;
  const deposit = ttc * 0.5;

  return {sd,ed,st,hpd,days,totalRequestedHours,fObj,baseHt,packsHt,totalHt,tva,ttc,deposit};
}

function updateSummary(c){
  id('sum-period').textContent = (c.sd&&c.ed)?`${id('f-start-date').value} ‚Üí ${id('f-end-date').value} (arriv√©e ${c.st||'‚Äî'})`:'‚Äî';
  id('sum-days').textContent = c.days;
  id('sum-hpd').textContent  = c.hpd.toString().replace('.',',');
  id('sum-hours').textContent= `${c.totalRequestedHours.toLocaleString('fr-FR')} h`;
  id('sum-base').textContent = ‚Ç¨.format(c.baseHt);
  id('sum-packs').textContent= ‚Ç¨.format(c.packsHt);
  id('sum-ht').textContent   = ‚Ç¨.format(c.totalHt);
  id('sum-tva').textContent  = ‚Ç¨.format(c.tva);
  id('sum-ttc').textContent  = ‚Ç¨.format(c.ttc);
  id('sum-deposit').textContent = ‚Ç¨.format(c.deposit);
}

function updateContract(c){
  const fLabel = c.fObj ? `${c.fObj.label} (${c.fObj.unitHours}h)` : '‚Äî';
  id('c_sum-period').textContent  = (c.sd&&c.ed)?`${id('f-start-date').value} ‚Üí ${id('f-end-date').value} (arriv√©e ${c.st||'‚Äî'})`:'‚Äî';
  id('c_sum-hpd').textContent     = c.hpd.toString().replace('.',',')+' h';
  id('c_sum-formula').textContent = fLabel;
  id('c_sum-packs').textContent   = ‚Ç¨.format(c.packsHt);
  id('c_sum-ht').textContent      = ‚Ç¨.format(c.totalHt);
  id('c_sum-tva').textContent     = ‚Ç¨.format(c.tva);
  id('c_sum-ttc').textContent     = ‚Ç¨.format(c.ttc);
  id('c_sum-deposit').textContent = ‚Ç¨.format(c.deposit);
}

function updateMailLink(c){
  const subject = encodeURIComponent(`Demande de location de fauteuil ‚Äî ${id('f-name').value||''}`);
  const body = encodeURIComponent(
`Demande de location ‚Äî PHENO&CO
Nom: ${id('f-name').value||'-'}
T√©l√©phone: ${id('f-phone').value||'-'}
P√©riode: du ${id('f-start-date').value||'-'} ${id('f-start-time').value||'-'} au ${id('f-end-date').value||'-'}
Heures/jour: ${c.hpd}
Formule: ${c.fObj ? c.fObj.label : '-'}
Packs HT: ${‚Ç¨.format(c.packsHt)}
Total HT: ${‚Ç¨.format(c.totalHt)}
TVA 20%: ${‚Ç¨.format(c.tva)}
Total TTC: ${‚Ç¨.format(c.ttc)}
Acompte 50%: ${‚Ç¨.format(c.deposit)}
Message: ${id('f-note').value||'-'}

CGV/Contrat: accept√© si coch√©. Merci d‚Äôenvoyer le lien de paiement de l‚Äôacompte 50%.`
  );
  id('emailLink').href = `mailto:${EMAIL}?subject=${subject}&body=${body}`;
}

function updateAll(){
  const c=compute();
  updateSummary(c);
  updateContract(c);
  updateMailLink(c);
}

/* Listeners */
['f-start-date','f-end-date','f-start-time','f-hours-per-day','f-note','f-name','f-phone']
  .forEach(fid=>id(fid).addEventListener('input', updateAll));
id('f-formula').addEventListener('change', updateAll);
qa('input[name="packs"]').forEach(c=>c.addEventListener('change', updateAll));

/* Init calcul */
updateAll();

/* Soumission WhatsApp */
id('chairForm').addEventListener('submit', (e)=>{
  e.preventDefault();
  const c=compute();
  if(!(id('f-name').value.trim() && id('f-phone').value.trim() && id('f-start-date').value && id('f-end-date').value && id('f-start-time').value && id('f-hours-per-day').value && c.fObj)){
    alert('Merci de remplir identit√©, p√©riode, heures/jour et formule.'); return;
  }
  if(!id('f-cgv').checked){ alert('Merci de lire et d‚Äôaccepter les CGV & contrat.'); return; }

  const msg =
`Demande de location de fauteuil ‚Äî PHENO&CO
‚Ä¢ Nom: ${id('f-name').value.trim()}
‚Ä¢ T√©l√©phone: ${id('f-phone').value.trim()}
‚Ä¢ P√©riode: ${id('f-start-date').value} ‚Üí ${id('f-end-date').value} (arriv√©e ${id('f-start-time').value})
‚Ä¢ Heures/jour: ${c.hpd}
‚Ä¢ Formule: ${c.fObj.label} (${c.fObj.unitHours}h)
‚Ä¢ Base HT: ${‚Ç¨.format(c.baseHt)}
‚Ä¢ Packs HT: ${‚Ç¨.format(c.packsHt)}
‚Ä¢ Total HT: ${‚Ç¨.format(c.totalHt)}
‚Ä¢ TVA: ${‚Ç¨.format(c.tva)}
‚Ä¢ Total TTC: ${‚Ç¨.format(c.ttc)}
‚Ä¢ Acompte 50%: ${‚Ç¨.format(c.deposit)}
‚Ä¢ Message: ${(id('f-note').value||'-').trim()}

CGV/Contrat: accept√© ‚úÖ
Merci d‚Äôenvoyer le lien de paiement 50%.`;
  id('helper').style.display='block';
  window.open(`https://wa.me/${PHONE}?text=${encodeURIComponent(msg)}`,'_blank','noopener');
});

/* CGV modal */
const modal=id('cgvModal');
id('openCgv').addEventListener('click',(e)=>{ e.preventDefault(); updateAll(); modal.style.display='flex'; modal.setAttribute('aria-hidden','false'); });
id('closeCgv').addEventListener('click',(e)=>{ e.preventDefault(); modal.style.display='none'; modal.setAttribute('aria-hidden','true'); });
</script>
</body>
</html>
