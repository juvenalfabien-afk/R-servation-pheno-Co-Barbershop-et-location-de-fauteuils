<!doctype html>
<html lang="fr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>PHENO&CO ‚Äî R√©servation de fauteuil</title>
<meta name="color-scheme" content="dark light">
<style>
  :root{
    --bg:#0b0b0b; --card:#111; --line:#1f1f1f;
    --fg:#f7f7f7; --muted:#bdbdbd;
    --yellow:#ffd400; --grey:#2d3138; --green:#25D366; --focus:#8ab4f8;
    --radius:20px;
  }
  *{box-sizing:border-box}
  html{scroll-behavior:smooth}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:var(--bg);color:var(--fg)}
  .wrap{max-width:980px;margin:0 auto;padding:28px 18px 64px}
  header{text-align:center;margin-bottom:8px}
  img.logo{width:260px;max-width:50vw;height:auto;border-radius:12px}
  h1{margin:8px 0 6px;font-size:40px;color:var(--yellow)}
  .sub{margin:0 0 26px;color:var(--muted);text-align:center}
  .grid{display:grid;gap:14px;margin:0 auto 28px;grid-template-columns:1fr}
  @media(min-width:720px){.grid{grid-template-columns:repeat(3,1fr)}}
  .btn{display:block;padding:18px 20px;border-radius:var(--radius);text-decoration:none;font-weight:800;text-align:center;line-height:1.2;box-shadow:0 1px 0 rgba(255,255,255,.06) inset,0 12px 28px rgba(0,0,0,.35);transition:.15s}
  .btn:focus-visible{outline:3px solid var(--focus);outline-offset:2px}
  .btn:active{transform:translateY(1px)}
  .btn-yellow{background:var(--yellow);color:#000}
  .btn-grey{background:var(--grey);color:#fff;border:2px solid #464b54}
  .btn-green{background:var(--green);color:#000}
  footer{margin-top:40px;color:#999;text-align:center;font-size:12px}

  /* MODAL (formulaire) */
  .modal{position:fixed;inset:0;background:rgba(0,0,0,.6);display:none;align-items:center;justify-content:center;padding:18px;z-index:999}
  .modal .box{max-width:900px;width:100%;background:#0f0f0f;border:1px solid #222;border-radius:18px;padding:18px;max-height:88vh;overflow:auto}
  .modal .box h2{margin:0 0 10px;color:var(--yellow)}
  .close{display:inline-block;margin-top:10px;padding:10px 14px;background:#222;border:1px solid #333;border-radius:10px;color:#fff;text-decoration:none}

  /* Form */
  label{display:block;margin:10px 0 6px}
  input,select,textarea{width:100%;padding:12px;border-radius:12px;border:1px solid #2a2a2a;background:#121212;color:#fff;font-size:16px}
  input[type="date"]{padding:10px 12px;cursor:pointer}
  textarea{min-height:96px;resize:vertical}
  .row{display:grid;gap:12px}
  @media(min-width:680px){.row{grid-template-columns:1fr 1fr}}
  .section-title{font-weight:900;color:#fff;margin:12px 0 6px}
  .accent{color:#000;background:var(--yellow);padding:2px 8px;border-radius:8px;margin-left:8px}
  .prices-hint{margin-top:6px;color:#000;background:var(--yellow);display:inline-block;padding:4px 10px;border-radius:999px;font-weight:900}

  .date-wrap{display:grid;grid-template-columns:1fr auto;gap:8px;align-items:end}
  .small{font-size:12px;color:#9aa0a6}
  .inline-fallback{display:none;background:#121212;border:1px dashed #2a2a2a;border-radius:10px;padding:8px}
  .inline-fallback .row3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:8px}

  .summary{border-top:1px dashed #2b2b2b;margin-top:16px;padding-top:12px;color:#e6e6e6}
  .summary small{color:var(--muted)}
  ul.packs{list-style:none;padding:0;margin:0;display:grid;gap:8px}
  ul.packs li{display:flex;align-items:center;gap:10px}

  .actions{display:flex;gap:12px;margin-top:16px;flex-wrap:wrap}
  .btn-submit,.btn-reset{flex:1;min-width:160px;padding:14px 16px;border-radius:14px;border:none;font-weight:800;cursor:pointer}
  .btn-submit{background:var(--yellow);color:#000}
  .btn-reset{background:var(--grey);color:#fff}
</style>
</head>
<body>
<main class="wrap">
  <header>
    <img class="logo" src="logo.png" alt="Logo PHENO&CO" onerror="this.style.display='none'">
    <h1>PHENO&CO</h1>
    <p class="sub">Barbershop ‚Ä¢ Depuis 2009 ‚Ä¢ 18 Rue d'Alger, 34000 Montpellier</p>
  </header>

  <!-- 3 boutons -->
  <div class="grid" role="navigation" aria-label="Actions principales">
    <a class="btn btn-yellow" href="#" id="openForm">R√©server Fauteuil üí∫</a>
    <a class="btn btn-grey" href="https://phenoandco.com" target="_blank" rel="noopener">Prendre RDV Coiffure üíà</a>
    <a class="btn btn-green" href="https://wa.me/33769432605?text=Bonjour%20PHENO%26CO%20!" target="_blank" rel="noopener">Contact WhatsApp</a>
  </div>

  <footer>¬© PHENO&CO ‚Äî Tous droits r√©serv√©s</footer>
</main>

<!-- MODAL FORM -->
<div class="modal" id="formModal" aria-hidden="true">
  <div class="box" role="dialog" aria-modal="true" aria-labelledby="title-fauteuil">
    <h2 id="title-fauteuil">R√©server un fauteuil</h2>
    <p class="small">Calendriers cliquables (üìÖ). Si votre navigateur n‚Äôaffiche pas le calendrier, utilisez les menus ‚ÄúJour/Mois/Ann√©e‚Äù.</p>

    <form id="chairForm" autocomplete="on" novalidate>
      <!-- Identit√© -->
      <div class="row">
        <div>
          <label for="f-name">Nom et pr√©nom</label>
          <input id="f-name" name="name" required placeholder="Ex. Jean Dupont" />
        </div>
        <div>
          <label for="f-phone">T√©l√©phone</label>
          <input id="f-phone" name="phone" required inputmode="tel" placeholder="Ex. 06 12 34 56 78" />
        </div>
      </div>

      <!-- P√©riode -->
      <div class="row">
        <div>
          <label for="f-start-date">Date de d√©but</label>
          <div class="date-wrap">
            <input id="f-start-date" type="date" required />
            <button type="button" id="btn-sd">üìÖ</button>
          </div>
          <div class="inline-fallback" id="fb-sd">
            <div class="row3">
              <select id="sd-day"></select>
              <select id="sd-month"></select>
              <select id="sd-year"></select>
            </div>
            <div class="small">S√©lection manuelle (remplit la date ci-dessus)</div>
          </div>
        </div>
        <div>
          <label for="f-start-time">Heure d‚Äôarriv√©e (10:00‚Äì18:00)</label>
          <select id="f-start-time" required>
            <option value="10:00">10:00</option><option value="11:00">11:00</option>
            <option value="12:00">12:00</option><option value="13:00">13:00</option>
            <option value="14:00">14:00</option><option value="15:00">15:00</option>
            <option value="16:00">16:00</option><option value="17:00">17:00</option>
            <option value="18:00">18:00</option>
          </select>
        </div>
      </div>

      <div class="row">
        <div>
          <label for="f-end-date">Date de fin</label>
          <div class="date-wrap">
            <input id="f-end-date" type="date" required />
            <button type="button" id="btn-ed">üìÖ</button>
          </div>
          <div class="inline-fallback" id="fb-ed">
            <div class="row3">
              <select id="ed-day"></select>
              <select id="ed-month"></select>
              <select id="ed-year"></select>
            </div>
            <div class="small">S√©lection manuelle (remplit la date ci-dessus)</div>
          </div>
        </div>
        <div>
          <label for="f-hours-per-day">Heures par jour</label>
          <select id="f-hours-per-day" required>
            <option value="0.5">0,5 h</option><option value="1">1 h</option>
            <option value="1.5">1,5 h</option><option value="2">2 h</option>
            <option value="2.5">2,5 h</option><option value="3">3 h</option>
            <option value="3.5">3,5 h</option><option value="4">4 h</option>
            <option value="4.5">4,5 h</option><option value="5">5 h</option>
            <option value="5.5">5,5 h</option><option value="6">6 h</option>
            <option value="6.5">6,5 h</option><option value="7">7 h</option>
            <option value="7.5">7,5 h</option><option value="8">8 h</option>
          </select>
          <div class="small">Ex. 4h = 10:00 ‚Üí 14:00</div>
        </div>
      </div>

      <!-- Formule (menu d√©roulant avec tarifs visibles) -->
      <div class="section-title">Formule <span class="accent">tarifs</span></div>
      <label for="f-formula">Choisir une formule (tarifs HT affich√©s)</label>
      <select id="f-formula" required>
        <option value="">S√©lectionner‚Ä¶</option>
        <option value="hour">Horaire ‚Äî 1h = 10,00 ‚Ç¨ HT</option>
        <option value="halfday">Demi-journ√©e ‚Äî 4h = 40,00 ‚Ç¨ HT</option>
        <option value="fullday">Journ√©e ‚Äî 8h = 80,00 ‚Ç¨ HT</option>
        <option value="week">Semaine ‚Äî 40h = 400,00 ‚Ç¨ HT</option>
        <option value="month">Mois ‚Äî 160h = 1 600,00 ‚Ç¨ HT</option>
      </select>
      <div class="prices-hint">Horaire 10‚Ç¨/h ‚Ä¢ 1/2j 40‚Ç¨ ‚Ä¢ 1j 80‚Ç¨ ‚Ä¢ 1 sem. 400‚Ç¨ ‚Ä¢ 1 mois 1600‚Ç¨ (HT)</div>

      <!-- Packs petit mat√©riel en location -->
      <div class="section-title">Packs petit mat√©riel <span class="accent">en location</span></div>
      <ul class="packs">
        <li><label><input type="checkbox" name="packs" value="5"> Pack Tondeuse Pro ‚Äî 5,00 ‚Ç¨ HT</label></li>
        <li><label><input type="checkbox" name="packs" value="8"> Pack Produits ‚Äî 8,00 ‚Ç¨ HT</label></li>
        <li><label><input type="checkbox" name="packs" value="4"> Pack Serviettes ‚Äî 4,00 ‚Ç¨ HT</label></li>
      </ul>

      <!-- Note -->
      <label for="f-note">Message (optionnel)</label>
      <textarea id="f-note" placeholder="Ex. Poste miroir 2, st√©rilisateur, horaires 10h‚Äì14h‚Ä¶"></textarea>

      <!-- CGV -->
      <label style="display:flex;align-items:center;gap:8px;margin-top:14px">
        <input type="checkbox" id="f-cgv" required>
        <span>J‚Äôai lu et j‚Äôaccepte les <a href="#" id="openCgv" style="color:#8ab4f8">CGV & contrat</a> personnalis√©s.</span>
      </label>

      <!-- R√©sum√© -->
      <div class="summary" id="summary">
        <div><small>P√©riode :</small> <span id="sum-period">‚Äî</span></div>
        <div><small>Jours compt√©s :</small> <span id="sum-days">0</span></div>
        <div><small>Heures/jour :</small> <span id="sum-hpd">0</span></div>
        <div><small>Dur√©e totale :</small> <span id="sum-hours">0 h</span></div>
        <div><small>Base HT :</small> <span id="sum-base">0 ‚Ç¨</span></div>
        <div><small>Packs HT :</small> <span id="sum-packs">0 ‚Ç¨</span></div>
        <div><small>Total HT :</small> <span id="sum-ht">0 ‚Ç¨</span></div>
        <div><small>TVA (20%) :</small> <span id="sum-tva">0 ‚Ç¨</span></div>
        <div><b>Total TTC :</b> <span id="sum-ttc">0 ‚Ç¨</span></div>
        <div><small>Acompte 50% :</small> <span id="sum-deposit">0 ‚Ç¨</span></div>
      </div>

      <!-- Actions -->
      <div class="actions">
        <button class="btn-submit" type="submit">Confirmer & envoyer (WhatsApp)</button>
        <button class="btn-reset" type="reset">Effacer</button>
        <a id="emailLink" class="btn btn-grey" href="#" target="_blank" rel="noopener">Envoyer aussi par e-mail</a>
      </div>
      <p id="helper" class="small" style="display:none;margin-top:10px;">WhatsApp s‚Äôouvre. Si rien, v√©rifie le bloqueur de fen√™tres.</p>
    </form>

    <!-- CGV Modal -->
    <div class="modal" id="cgvModal" aria-hidden="true" style="background:rgba(0,0,0,.7)">
      <div class="box" role="dialog" aria-modal="true" aria-labelledby="cgvTitle">
        <h3 id="cgvTitle" style="color:var(--yellow)">CGV & Contrat ‚Äî PHENO&CO</h3>
        <div class="contract" style="color:#ddd">
          <h4>R√©capitulatif personnalis√©</h4>
          <ul>
            <li><b>P√©riode :</b> <span id="c_sum-period">‚Äî</span></li>
            <li><b>Heures/jour :</b> <span id="c_sum-hpd">‚Äî</span></li>
            <li><b>Formule :</b> <span id="c_sum-formula">‚Äî</span></li>
            <li><b>Packs HT :</b> <span id="c_sum-packs">‚Äî</span></li>
            <li><b>Total HT :</b> <span id="c_sum-ht">‚Äî</span></li>
            <li><b>TVA 20% :</b> <span id="c_sum-tva">‚Äî</span></li>
            <li><b>Total TTC :</b> <span id="c_sum-ttc">‚Äî</span></li>
            <li><b>Acompte 50% :</b> <span id="c_sum-deposit">‚Äî</span></li>
          </ul>
          <h4>Principes</h4>
          <p>Horaires 10:00‚Äì18:00, hygi√®ne et mat√©riel respect√©s, acompte 50% √† la confirmation (lien envoy√©), solde √† l‚Äôarriv√©e.</p>
        </div>
        <a href="#" class="close" id="closeCgv">Fermer</a>
      </div>
    </div>

    <a href="#" class="close" id="closeForm">Fermer</a>
  </div>
</div>

<script>
/* ===== CONFIG ===== */
const PHONE = '33769432605';
const EMAIL = 'location.phenoandco@gmail.com';
const HOURLY_HT = 10;  // ‚Ç¨ HT / h
const TVA_RATE = 0.20;

/* ===== OUTILS ===== */
const ‚Ç¨ = new Intl.NumberFormat('fr-FR',{style:'currency',currency:'EUR'});
const id = s=>document.getElementById(s);
const qa = (s,root=document)=>Array.from(root.querySelectorAll(s));

/* ===== OUVERTURE/FERMETURE MODAL FORM ===== */
const modal = id('formModal');
id('openForm').addEventListener('click', (e)=>{ e.preventDefault(); modal.style.display='flex'; modal.setAttribute('aria-hidden','false'); initDefaults(); updateAll(); });
id('closeForm').addEventListener('click', (e)=>{ e.preventDefault(); modal.style.display='none'; modal.setAttribute('aria-hidden','true'); });

/* ===== Init dates par d√©faut + showPicker + fallback menus (J/M/A) ===== */
function setTodayMin(input){
  const t=new Date(), s=`${t.getFullYear()}-${String(t.getMonth()+1).padStart(2,'0')}-${String(t.getDate()).padStart(2,'0')}`;
  input.value=s; input.min=s;
}
function tryOpenPicker(input){
  try{ if(typeof input.showPicker==='function'){ input.showPicker(); return true; } }catch(_){}
  return false;
}
function buildDateFallback(prefix, targetInput){
  const dSel=id(`${prefix}-day`), mSel=id(`${prefix}-month`), ySel=id(`${prefix}-year`);
  // jours 1..31
  for(let d=1; d<=31; d++) dSel.appendChild(new Option(String(d).padStart(2,'0'), String(d).padStart(2,'0')));
  // mois 1..12
  const mois=['01','02','03','04','05','06','07','08','09','10','11','12'];
  mois.forEach(m=>mSel.appendChild(new Option(m,m)));
  // ann√©es courantes (ann√©e en cours et +1)
  const y=new Date().getFullYear();
  [y, y+1].forEach(Y=>ySel.appendChild(new Option(String(Y), String(Y))));
  // sync -> input type=date
  function sync(){ targetInput.value = `${ySel.value}-${mSel.value}-${dSel.value}`; updateAll(); }
  dSel.onchange = mSel.onchange = ySel.onchange = sync;
}
function initDefaults(){
  setTodayMin(id('f-start-date'));
  setTodayMin(id('f-end-date'));
  // essais open picker via boutons
  id('btn-sd').onclick=()=>{ if(!tryOpenPicker(id('f-start-date'))) id('fb-sd').style.display='block'; };
  id('btn-ed').onclick=()=>{ if(!tryOpenPicker(id('f-end-date'))) id('fb-ed').style.display='block'; };
  // fallback menus
  buildDateFallback('sd', id('f-start-date'));
  buildDateFallback('ed', id('f-end-date'));
  // valeurs par d√©faut
  id('f-start-time').value='10:00';
  id('f-hours-per-day').value='4';
  id('f-formula').value='';
}

/* ===== CALCULS ===== */
function sumPacks(){ return qa('input[name="packs"]:checked').reduce((s,el)=>s+Number(el.value),0); }
function daysBetweenInclusive(a,b){
  if(!a||!b) return 0;
  const A=new Date(a), B=new Date(b); A.setHours(0,0,0,0); B.setHours(0,0,0,0);
  return Math.floor((B-A)/86400000)+1;
}
function compute(){
  const sd=id('f-start-date').value, ed=id('f-end-date').value;
  const st=id('f-start-time').value;
  const hpd=parseFloat(id('f-hours-per-day').value||'0')||0;
  const days=daysBetweenInclusive(sd,ed);
  const key=id('f-formula').value;
  const units = key==='hour'?1 : key==='halfday'?4 : key==='fullday'?8 : key==='week'?40 : key==='month'?160 : 0;
  const totalRequestedHours = Math.max(0,days*hpd);
  const baseHours = key==='hour' ? totalRequestedHours : Math.ceil(totalRequestedHours/units)*units;
  const baseHt = baseHours*HOURLY_HT;
  const packsHt = sumPacks();
  const totalHt = baseHt+packsHt;
  const tva = totalHt*TVA_RATE;
  const ttc = totalHt+tva;
  const deposit = ttc*0.5;
  return {sd,ed,st,hpd,days,totalRequestedHours, key, units, baseHt, packsHt, totalHt, tva, ttc, deposit};
}
function updateAll(){
  const c=compute();
  id('sum-period').textContent = (c.sd&&c.ed)?`${c.sd} ‚Üí ${c.ed} (arriv√©e ${c.st||'‚Äî'})`:'‚Äî';
  id('sum-days').textContent = c.days;
  id('sum-hpd').textContent = (c.hpd||0).toString().replace('.',',');
  id('sum-hours').textContent = `${(c.totalRequestedHours||0).toLocaleString('fr-FR')} h`;
  id('sum-base').textContent = ‚Ç¨.format(c.baseHt||0);
  id('sum-packs').textContent= ‚Ç¨.format(c.packsHt||0);
  id('sum-ht').textContent   = ‚Ç¨.format(c.totalHt||0);
  id('sum-tva').textContent  = ‚Ç¨.format(c.tva||0);
  id('sum-ttc').textContent  = ‚Ç¨.format(c.ttc||0);
  id('sum-deposit').textContent = ‚Ç¨.format(c.deposit||0);

  // CGV recap
  const label = c.key==='hour'?'Horaire'
              : c.key==='halfday'?'Demi-journ√©e (4h)'
              : c.key==='fullday'?'Journ√©e (8h)'
              : c.key==='week'?'Semaine (40h)'
              : c.key==='month'?'Mois (160h)'
              : '‚Äî';
  document.getElementById('c_sum-period').textContent = id('sum-period').textContent;
  document.getElementById('c_sum-hpd').textContent    = (c.hpd||0).toString().replace('.',',')+' h';
  document.getElementById('c_sum-formula').textContent= label;
  document.getElementById('c_sum-packs').textContent  = ‚Ç¨.format(c.packsHt||0);
  document.getElementById('c_sum-ht').textContent     = ‚Ç¨.format(c.totalHt||0);
  document.getElementById('c_sum-tva').textContent    = ‚Ç¨.format(c.tva||0);
  document.getElementById('c_sum-ttc').textContent    = ‚Ç¨.format(c.ttc||0);
  document.getElementById('c_sum-deposit').textContent= ‚Ç¨.format(c.deposit||0);

  // email link
  const subject=encodeURIComponent(`Demande de location de fauteuil ‚Äî ${id('f-name').value||''}`);
  const body=encodeURIComponent(
`Demande de location ‚Äî PHENO&CO
Nom: ${id('f-name').value||'-'}
T√©l√©phone: ${id('f-phone').value||'-'}
P√©riode: du ${c.sd||'-'} ${c.st||'-'} au ${c.ed||'-'}
Heures/jour: ${c.hpd||0}
Formule: ${label}
Packs HT: ${‚Ç¨.format(c.packsHt||0)}
Total HT: ${‚Ç¨.format(c.totalHt||0)}
TVA 20%: ${‚Ç¨.format(c.tva||0)}
Total TTC: ${‚Ç¨.format(c.ttc||0)}
Acompte 50%: ${‚Ç¨.format(c.deposit||0)}
Message: ${id('f-note').value||'-'}

CGV/Contrat: accept√© si coch√©. Merci d‚Äôenvoyer le lien de paiement de l‚Äôacompte 50%.`);
  id('emailLink').href=`mailto:${EMAIL}?subject=${subject}&body=${body}`;
}

/* listeners */
['f-start-date','f-end-date','f-start-time','f-hours-per-day','f-formula','f-note','f-name','f-phone']
  .forEach(fid=>id(fid).addEventListener('input', updateAll));

/* Soumission WhatsApp */
id('chairForm').addEventListener('submit', (e)=>{
  e.preventDefault();
  const c=compute();
  if(!(id('f-name').value.trim() && id('f-phone').value.trim() && c.sd && c.ed && c.st && id('f-formula').value)){
    alert('Merci de remplir identit√©, p√©riode, heures/jour et formule.'); return;
  }
  if(!id('f-cgv').checked){ alert('Merci d‚Äôaccepter les CGV & contrat.'); return; }

  const label = document.querySelector('#f-formula option:checked').textContent.split(' ‚Äî ')[0];
  const msg =
`Demande de location de fauteuil ‚Äî PHENO&CO
‚Ä¢ Nom: ${id('f-name').value.trim()}
‚Ä¢ T√©l√©phone: ${id('f-phone').value.trim()}
‚Ä¢ P√©riode: ${c.sd} ‚Üí ${c.ed} (arriv√©e ${c.st})
‚Ä¢ Heures/jour: ${c.hpd}
‚Ä¢ Formule: ${label}
‚Ä¢ Base HT: ${‚Ç¨.format(c.baseHt)}
‚Ä¢ Packs HT: ${‚Ç¨.format(c.packsHt)}
‚Ä¢ Total HT: ${‚Ç¨.format(c.totalHt)}
‚Ä¢ TVA: ${‚Ç¨.format(c.tva)}
‚Ä¢ Total TTC: ${‚Ç¨.format(c.ttc)}
‚Ä¢ Acompte 50%: ${‚Ç¨.format(c.deposit)}
‚Ä¢ Message: ${(id('f-note').value||'-').trim()}

CGV/Contrat: accept√© ‚úÖ
Merci d‚Äôenvoyer le lien de paiement 50%.`;

  id('helper').style.display='block';
  window.open(`https://wa.me/${PHONE}?text=${encodeURIComponent(msg)}`,'_blank','noopener');
});

/* CGV modal open/close */
const cgvModal = document.getElementById('cgvModal');
document.getElementById('openCgv').addEventListener('click',(e)=>{ e.preventDefault(); updateAll(); cgvModal.style.display='flex'; cgvModal.setAttribute('aria-hidden','false'); });
document.getElementById('closeCgv').addEventListener('click',(e)=>{ e.preventDefault(); cgvModal.style.display='none'; cgvModal.setAttribute('aria-hidden','true'); });

</script>
</body>
</html>
