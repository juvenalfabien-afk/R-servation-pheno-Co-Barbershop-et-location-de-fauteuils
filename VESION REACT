import React, { useState, useEffect } from "react";
import { useForm, useWatch } from "react-hook-form";
import { Calendar, Clock, User, Info, AlertCircle, Check, ArrowRight, Scissors, MessageCircle, Calendar as CalendarIcon } from "lucide-react";
import { useToast } from "@/hooks/use-toast";
import logoUrl from "@assets/Copie de LOGO PHENO&CO  (Vid√©o mobile)_1763667486157.png";
import { differenceInDays, differenceInMinutes, parse, format } from "date-fns";
import emailjs from '@emailjs/browser';

type ReservationFormValues = {
  dateDebut: string;
  dateFin: string;
  heureDebut: string;
  heureFin: string;
  duree: "courte" | "longue";
  formuleCourte: string;
  formuleLongue: string;
  packMateriel: string;
  nom: string;
  email: string;
  telephone: string;
  statut: string;
  experience: string;
  specialites: string[];
  certif_3ans: boolean;
  certif_diplome: boolean;
  certif_docs: boolean;
  commentaire: string;
  cgv: boolean;
};

// --- CONSTANTS & DATA ---
const TIME_SLOTS: string[] = [];
// We will generate more granular slots to support 17:30, but filter them later based on the day.
// Start from 10:00 to 18:00 in 30min increments.
for (let h = 10; h <= 18; h++) {
  TIME_SLOTS.push(`${h.toString().padStart(2, '0')}:00`);
  if (h < 18) TIME_SLOTS.push(`${h.toString().padStart(2, '0')}:30`);
}

// Helper to check if a time string is within range
const isTimeInRange = (time: string, min: string, max: string) => {
  const t = parseInt(time.replace(':', ''));
  const mn = parseInt(min.replace(':', ''));
  const mx = parseInt(max.replace(':', ''));
  return t >= mn && t <= mx;
};

// Helper to get opening hours for a specific date
const getOpeningHours = (dateStr: string) => {
  if (!dateStr) return { start: "10:00", end: "18:00" }; // Default
  const d = new Date(dateStr);
  const day = d.getDay(); // 0=Sun, 1=Mon, 2=Tue, 3=Wed, ...
  
  if (day === 3) { // Wednesday
    return { start: "12:00", end: "17:30" };
  }
  return { start: "10:00", end: "18:00" }; // Other days (Tue, Thu, Fri, Sat)
};

const PRICING = {
  courte: {
    heure: { price: 10, label: "√Ä l'heure ‚Äî 10 ‚Ç¨ HT" },
    demi: { price: 35, label: "Demi-journ√©e (4h) ‚Äî 35 ‚Ç¨ HT" },
    journee: { price: 65, label: "Journ√©e ‚Äî 65 ‚Ç¨ HT" },
  },
  longue: {
    "1mois": { price: 65, label: "1 mois ‚Äî 65 ‚Ç¨ HT/jour" },
    "3mois": { price: 60, label: "3 mois ‚Äî 60 ‚Ç¨ HT/jour" },
    "6mois": { price: 55, label: "6 mois ‚Äî 55 ‚Ç¨ HT/jour" },
    "12mois": { price: 50, label: "12 mois ‚Äî 50 ‚Ç¨ HT/jour" },
  },
  pack: {
    aucun: { price: 0, label: "Aucun ‚Äî 0 ‚Ç¨" },
    essentiel: { price: 20, label: "Pack Essentiel ‚Äî 20 ‚Ç¨ HT / jour" },
    premium: { price: 30, label: "Pack Premium ‚Äî 30 ‚Ç¨ HT / jour" },
  },
};

// Helper function to generate Google Calendar link
const getGoogleCalendarLink = (title: string, details: string, startDate: string, endDate: string, startTime: string, endTime: string) => {
  // Format dates to YYYYMMDDTHHmmssZ (UTC) or YYYYMMDDTHHmmss (Local time)
  // Since we don't know timezone, let's assume local time for simplicity or try to construct ISO string
  // Format: YYYYMMDDTHHmmss
  
  const start = new Date(`${startDate}T${startTime}:00`);
  // If endDate is not provided (short term single day), use startDate
  const end = endDate ? new Date(`${endDate}T${endTime}:00`) : new Date(`${startDate}T${endTime}:00`);

  const formatTime = (date: Date) => {
    return date.toISOString().replace(/-|:|\.\d\d\d/g, "").substring(0, 15) + "Z"; // Using UTC (Z) requires correct offset handling, but let's stick to ISO string conversion which usually includes Z if created from UTC or handles timezone.
    // A safer way for "floating" time (user's timezone) is just YYYYMMDDTHHmmss
    // but let's do a simple string manipulation for local time to avoid timezone confusion if possible, 
    // OR just use the ISO string. 
    // Let's use simple ISO string and strip milliseconds and separators.
  };

  const s = formatTime(start);
  const e = formatTime(end);

  const url = new URL("https://www.google.com/calendar/render");
  url.searchParams.append("action", "TEMPLATE");
  url.searchParams.append("text", title);
  url.searchParams.append("details", details);
  url.searchParams.append("dates", `${s}/${e}`);
  url.searchParams.append("location", "PHENO&CO, Montpellier");

  return url.toString();
};


export default function ReservationPage() {
  const { toast } = useToast();
  const today = new Date();
  const tomorrow = new Date(today);
  tomorrow.setDate(tomorrow.getDate() + 1);
  const tomorrowStr = tomorrow.toISOString().split("T")[0];

  const [emailSent, setEmailSent] = useState(false);
  const [sending, setSending] = useState(false);
  const [emailError, setEmailError] = useState<string | null>(null);
  const [calendarLink, setCalendarLink] = useState("");

  useEffect(() => {
    emailjs.init("uBxESnC6CTyqiNyS6");
  }, []);

  const form = useForm<ReservationFormValues>({
    defaultValues: {
      duree: "courte",
      formuleCourte: "heure",
      formuleLongue: "semaine",
      packMateriel: "aucun",
      dateDebut: tomorrowStr,
      dateFin: "",
      heureDebut: "10:00",
      heureFin: "11:00",
      cgv: false,
      statut: "auto",
      experience: "0-3",
      specialites: [],
      certif_3ans: false,
      certif_diplome: false,
      certif_docs: false,
    },
  });

  const { register, control, handleSubmit, watch, setValue } = form;
  const values = useWatch({ control });

  // --- PERSISTENCE LOGIC ---
  useEffect(() => {
    const savedData = localStorage.getItem("reservationFormData");
    if (savedData) {
      try {
        const parsed = JSON.parse(savedData);
        // Only restore if data isn't too old (optional, but good practice, let's just restore for now)
        // Iterate and set values
        Object.keys(parsed).forEach((key) => {
           // @ts-ignore
           setValue(key, parsed[key]);
        });
      } catch (e) {
        console.error("Failed to parse saved form data", e);
      }
    }
  }, [setValue]);

  useEffect(() => {
    const subscription = watch((value) => {
      localStorage.setItem("reservationFormData", JSON.stringify(value));
    });
    return () => subscription.unsubscribe();
  }, [watch]);

  // --- LOGIC & CONSTRAINTS ---
  const [availableStartTimes, setAvailableStartTimes] = useState<string[]>(TIME_SLOTS);
  const [availableEndTimes, setAvailableEndTimes] = useState<string[]>(TIME_SLOTS);
  const [lastValidatedDates, setLastValidatedDates] = useState<{dateDebut: string, dateFin: string}>({dateDebut: "", dateFin: ""});

  useEffect(() => {
    // 1. Block Sunday (0) and Monday (1) - only show toast when date actually changes to a blocked day
    const validateDay = (dateStr: string, field: "dateDebut" | "dateFin", lastValue: string) => {
      if (!dateStr) return true;
      
      // Skip if we already validated this exact date
      if (dateStr === lastValue) return true;
      
      const d = new Date(dateStr);
      const day = d.getDay();
      if (day === 0 || day === 1) {
        toast({
          title: "Jour de fermeture",
          description: "Le salon est ferm√© le dimanche et le lundi. Merci de choisir une autre date.",
          variant: "destructive"
        });
        setValue(field, "");
        return false;
      }
      return true;
    };
    
    const currentDateDebut = values.dateDebut || "";
    const currentDateFin = values.dateFin || "";
    
    const validStart = validateDay(currentDateDebut, "dateDebut", lastValidatedDates.dateDebut);
    const validEnd = validateDay(currentDateFin, "dateFin", lastValidatedDates.dateFin);
    
    // Update tracked dates only if they are valid (not blocked days)
    if (validStart && currentDateDebut !== lastValidatedDates.dateDebut) {
      setLastValidatedDates(prev => ({...prev, dateDebut: currentDateDebut}));
    }
    if (validEnd && currentDateFin !== lastValidatedDates.dateFin) {
      setLastValidatedDates(prev => ({...prev, dateFin: currentDateFin}));
    }

    // 2. Filter Time Slots based on Day (Wed vs Others)
    if (values.dateDebut) {
      const hours = getOpeningHours(values.dateDebut);
      const filtered = TIME_SLOTS.filter(t => isTimeInRange(t, hours.start, hours.end));
      setAvailableStartTimes(filtered);
      
      // If current selection is invalid, reset
      if (!isTimeInRange(values.heureDebut || "", hours.start, hours.end)) {
         setValue("heureDebut", hours.start);
      }
    }

    // End time depends on dateFin if present, else dateDebut
    const endDateForHours = values.dateFin || values.dateDebut;
    if (endDateForHours) {
      const hours = getOpeningHours(endDateForHours);
      const filtered = TIME_SLOTS.filter(t => isTimeInRange(t, hours.start, hours.end));
      setAvailableEndTimes(filtered);

      // If current selection is invalid, reset
      if (!isTimeInRange(values.heureFin || "", hours.start, hours.end)) {
         // For end time, we might want default to end of day or +1h
         setValue("heureFin", hours.end);
      }
    }

    // 3. Enforce Hours based on Formula
    const duree = values.duree;
    const fCourte = values.formuleCourte;

    if (duree === "longue") {
      // Longue dur√©e = Free hours, but MUST be within opening hours (handled by filtered lists above)
    } 
    else if (duree === "courte") {
      if (fCourte === "journee") {
        // Journ√©e = Opening to Closing
        const hours = getOpeningHours(values.dateDebut || "");
        if (values.heureDebut !== hours.start) setValue("heureDebut", hours.start);
        if (values.heureFin !== hours.end) setValue("heureFin", hours.end);
      }
      else if (fCourte === "demi") {
        // Demi-journ√©e = Max 4h
        // Auto-adjust end time based on start time
        const start = values.heureDebut;
        if (start) {
          const [h, m] = start.split(':').map(Number);
          let endH = h + 4;
          let endM = m;
          
          // Max closing time
          const hours = getOpeningHours(values.dateDebut || "");
          const [maxH, maxM] = hours.end.split(':').map(Number);
          
          // Compare endH:endM with maxH:maxM
          if (endH > maxH || (endH === maxH && endM > maxM)) {
             // Clamp to max
             setValue("heureFin", hours.end);
          } else {
             const endStr = `${endH.toString().padStart(2, '0')}:${endM === 30 ? '30' : '00'}`;
             if (values.heureFin !== endStr) setValue("heureFin", endStr);
          }
        }
      }
    }
  }, [values.duree, values.formuleCourte, values.heureDebut, values.dateDebut, values.dateFin, setValue, toast]);

  // --- CALCULATION LOGIC ---
  const calculatePrice = () => {
    const dureeType = values.duree || "courte";
    const packType = values.packMateriel || "aucun";
    
    let baseHT = 0;
    let formuleLabel = "";
    let durationDetails = "";

    // Dates processing
    const start = values.dateDebut ? new Date(values.dateDebut) : new Date();
    const end = values.dateFin ? new Date(values.dateFin) : start;
    
    // Business Days Calculation (Tuesday to Saturday)
    const countBusinessDays = (startDate: Date, endDate: Date) => {
      let count = 0;
      let current = new Date(startDate);
      current.setHours(0, 0, 0, 0);
      const endD = new Date(endDate);
      endD.setHours(0, 0, 0, 0);

      while (current <= endD) {
        const day = current.getDay();
        // 0 = Sunday, 1 = Monday. We only count if day != 0 and day != 1
        if (day !== 0 && day !== 1) {
          count++;
        }
        current.setDate(current.getDate() + 1);
      }
      return Math.max(1, count); // Always at least 1 day if selected
    };

    const businessDays = countBusinessDays(start, end);

    if (dureeType === "courte") {
      const formule = values.formuleCourte || "heure";
      
      if (formule === "heure") {
        const hStart = parse(values.heureDebut || "10:00", "HH:mm", new Date());
        const hEnd = parse(values.heureFin || "11:00", "HH:mm", new Date());
        let minutes = differenceInMinutes(hEnd, hStart);
        if (minutes < 0) minutes = 0;
        const hours = minutes / 60;
        
        baseHT = hours * 10 * businessDays;
        formuleLabel = "√Ä l'heure ‚Äî 10 ‚Ç¨ HT";
        durationDetails = `${hours.toFixed(1)}h / jour sur ${businessDays} jours ouvr√©s`;
        
      } else if (formule === "demi") {
        baseHT = 35 * businessDays;
        formuleLabel = "Demi-journ√©e (4h) ‚Äî 35 ‚Ç¨ HT";
        durationDetails = `Demi-journ√©e (4h) x ${businessDays} jours ouvr√©s`;
        
      } else if (formule === "journee") {
        baseHT = 65 * businessDays;
        formuleLabel = "Journ√©e ‚Äî 65 ‚Ç¨ HT";
        durationDetails = `${businessDays} jours ouvr√©s`;
      }
    } else {
      // "Longue dur√©e" now handles Week and Month logic
      // NOTE: The UI radio buttons will need adjustment to match "Semaine" and "Mensuel" if they are separate "formulas"
      // BUT based on instruction: "GARDER UNIQUEMENT trois formules... FORMULE SEMAINE... FORMULE MENSUELLE"
      // It seems we should restructure the choice.
      
      const formule = values.formuleLongue || "semaine";
      
      if (formule === "semaine") {
         baseHT = 60 * businessDays;
         formuleLabel = "Semaine ‚Äî 60 ‚Ç¨ HT / jour";
         durationDetails = `${businessDays} jours ouvr√©s (Tarif Semaine)`;
      } else if (formule === "mensuel") {
         baseHT = 55 * businessDays;
         formuleLabel = "Mensuel ‚Äî 55 ‚Ç¨ HT / jour";
         durationDetails = `${businessDays} jours ouvr√©s (Tarif Mensuel)`;
      }
    }

    // @ts-ignore
    const packData = PRICING.pack[packType];
    // Pack calculation: Price per day * Business Days
    const packUnit = packData ? packData.price : 0;
    const packHT = packUnit * businessDays;
    const packLabel = packData ? packData.label : "";

    const totalHT = baseHT + packHT;
    const tva = totalHT * 0.2;
    const totalTTC = totalHT + tva;
    
    // Acompte: 50% for "courte" (heure/demi/journee), 25% for "longue" (semaine/mensuel)
    const acompteTaux = dureeType === "courte" ? 0.5 : 0.25;
    const acompteTTC = totalTTC * acompteTaux;
    const soldeTTC = totalTTC - acompteTTC;

    return {
      baseHT,
      formuleLabel,
      packHT,
      packLabel,
      totalHT,
      tva,
      totalTTC,
      acompteTaux,
      acompteTTC,
      soldeTTC,
      durationDetails
    };
  };

  const priceInfo = calculatePrice();

  // --- ROBUST EMAIL SENDING WITH RETRY ---
  const sendEmailWithRetry = async (serviceId: string, templateId: string, params: any, publicKey: string, retries = 3): Promise<any> => {
    for (let i = 0; i < retries; i++) {
      try {
        return await emailjs.send(serviceId, templateId, params, publicKey);
      } catch (error: any) {
        console.warn(`Attempt ${i + 1} failed:`, error);
        if (i === retries - 1) throw error; // Throw on last failure
        // Wait 1 second before retry
        await new Promise(resolve => setTimeout(resolve, 1000));
      }
    }
  };

  const onSubmit = async (data: ReservationFormValues) => {
    if (!data.cgv) return; 
    setSending(true);
    setEmailError(null);

    // Get base URL for links
    const baseUrl = window.location.origin;
    const cgvUrl = `${baseUrl}/cgv-location`;

    // Prepare Calendar Link
    const title = "Location Fauteuil - PHENO&CO";
    const details = `R√©servation de fauteuil.\nFormule: ${priceInfo.formuleLabel}\nPack: ${priceInfo.packLabel}\nTotal TTC: ${priceInfo.totalTTC.toFixed(2)}‚Ç¨`;
    const link = getGoogleCalendarLink(title, details, data.dateDebut, data.dateFin, data.heureDebut, data.heureFin);
    setCalendarLink(link);

    // Create a formatted text summary for the 'message' variable in EmailJS
    // This ensures the email content is populated even if the template uses a generic {{message}} tag
    const summaryText = `
R√âCAPITULATIF DE LA DEMANDE

--- CLIENT ---
Nom : ${data.nom}
Email : ${data.email}
T√©l√©phone : ${data.telephone}

--- PROFIL PROFESSIONNEL ---
Statut : ${data.statut}
Exp√©rience : ${data.experience}
Comp√©tences & Sp√©cialit√©s : ${data.specialites.join(", ") || "Aucune"}

--- ENGAGEMENTS ---
3 ans d'exp√©rience : ${data.certif_3ans ? "Oui" : "Non"}
Dipl√¥me (CAP/BP) : ${data.certif_diplome ? "Oui" : "Non"}
Documents justificatifs : ${data.certif_docs ? "Oui" : "Non"}
CGV & Contrat accept√©s : ${data.cgv ? "Oui" : "Non"}
Lien CGV & Contrat : ${cgvUrl}

--- P√âRIODE ---
Dates : Du ${data.dateDebut} au ${data.dateFin || 'Non pr√©cis√©'}
Horaires : De ${data.heureDebut} √† ${data.heureFin}
Dur√©e : ${priceInfo.durationDetails}

--- FORMULE ---
Type : ${data.duree === 'courte' ? 'Courte dur√©e' : 'Longue dur√©e'}
Formule : ${priceInfo.formuleLabel}
Pack Mat√©riel : ${priceInfo.packLabel}

--- TARIFS (Estimatif) ---
Base HT : ${priceInfo.baseHT.toFixed(2)} ‚Ç¨
Pack HT : ${priceInfo.packHT.toFixed(2)} ‚Ç¨
Total HT : ${priceInfo.totalHT.toFixed(2)} ‚Ç¨
TVA (20%) : ${priceInfo.tva.toFixed(2)} ‚Ç¨
TOTAL TTC : ${priceInfo.totalTTC.toFixed(2)} ‚Ç¨

--- PAIEMENT ---
Acompte √† r√©gler : ${priceInfo.acompteTTC.toFixed(2)} ‚Ç¨
Solde restant : ${priceInfo.soldeTTC.toFixed(2)} ‚Ç¨

--- COMMENTAIRE ---
${data.commentaire || 'Aucun'}

===================================
üìÖ AJOUTER √Ä MON AGENDA
Cliquez sur le lien ci-dessous :
${link}
===================================
    `.trim();

    // 1. Pr√©pare data for email
    const templateParams = {
      // Mapping for the specific template shown in screenshot
      name: data.nom, // Matches {{name}}
      message: summaryText, // Matches {{message}}
      title: "Nouvelle R√©servation Fauteuil", // Matches {{title}} if present
      
      // Specific fields mapping
      to_name: data.nom,
      to_email: data.email,
      manager_email: "location.phenoandco@gmail.com",
      
      // Profile Data
      statut: data.statut,
      experience: data.experience,
      specialites: data.specialites.join(", "),
      engagements_resume: `3 ans: ${data.certif_3ans ? "Oui" : "Non"}, Dipl√¥me: ${data.certif_diplome ? "Oui" : "Non"}, Docs: ${data.certif_docs ? "Oui" : "Non"}`,

      date_debut: data.dateDebut,
      date_fin: data.dateFin || "Non pr√©cis√©",
      heure_debut: data.heureDebut,
      heure_fin: data.heureFin,
      duree_details: priceInfo.durationDetails,
      type_location: data.duree === 'courte' ? 'Courte dur√©e' : 'Longue dur√©e',
      formule_label: priceInfo.formuleLabel,
      pack_label: priceInfo.packLabel,
      base_ht: priceInfo.baseHT.toFixed(2),
      pack_ht: priceInfo.packHT.toFixed(2),
      total_ht: priceInfo.totalHT.toFixed(2),
      tva: priceInfo.tva.toFixed(2),
      total_ttc: priceInfo.totalTTC.toFixed(2),
      acompte_taux: (priceInfo.acompteTaux * 100).toFixed(0),
      acompte_ttc: priceInfo.acompteTTC.toFixed(2),
      solde_ttc: priceInfo.soldeTTC.toFixed(2),
      telephone: data.telephone,
      commentaire: data.commentaire || "Aucun",
      calendar_link: link,
      
      certif_3ans: data.certif_3ans ? "Oui" : "Non",
      certif_diplome: data.certif_diplome ? "Oui" : "Non",
      certif_docs: data.certif_docs ? "Oui" : "Non",
      certif_cgv: data.cgv ? "Oui" : "Non",
    };

    const message = `
Bonjour ${data.nom},

Merci pour votre demande de location de fauteuil chez PHENO&CO.

Voici votre r√©capitulatif :
‚Äì Profil : ${data.statut}, ${data.experience} d'exp√©rience
‚Äì Sp√©cialit√©s : ${data.specialites.join(", ") || "Non pr√©cis√©"}
‚Äì Formule : ${priceInfo.formuleLabel}
‚Äì Dates : ${data.dateDebut} ‚Üí ${data.dateFin || 'Non pr√©cis√©'}
‚Äì Montant total : ${priceInfo.totalTTC.toFixed(2)} ‚Ç¨ TTC
‚Äì Acompte √† r√©gler : ${priceInfo.acompteTTC.toFixed(2)} ‚Ç¨ TTC (${(priceInfo.acompteTaux * 100).toFixed(0)}% ${data.duree === 'courte' ? 'courte dur√©e' : 'longue dur√©e'})

Pour valider votre r√©servation, merci de nous envoyer :
‚Äì une pi√®ce d'identit√©
‚Äì votre CAP/BP (ou √©quivalent)
‚Äì votre justificatif d'activit√© (SIREN/URSSAF)
‚Äì votre attestation d'assurance RC Pro (si vous la poss√©dez d√©j√†)

üìß Documents √† envoyer : location.phenoandco@gmail.com

D√®s que vos documents sont valid√©s, nous vous transmettons votre lien de paiement d'acompte et bloquons votre cr√©neau d√©finitivement.

Nous restons disponibles si vous avez des questions.
PHENO&CO

üìÑ CGV & Contrat : ${cgvUrl}

üìÖ AJOUTER √Ä VOTRE AGENDA GOOGLE :
${link}
    `.trim();

    const encoded = encodeURIComponent(message);
    const whatsappUrl = `https://wa.me/33769432605?text=${encoded}`;
    
    try {
      // STEP 1: Save to database
      const reservationData = {
        nom: data.nom,
        email: data.email,
        telephone: data.telephone,
        dateDebut: data.dateDebut,
        dateFin: data.dateFin || null,
        heureDebut: data.heureDebut,
        heureFin: data.heureFin,
        duree: data.duree,
        formuleCourte: data.duree === 'courte' ? data.formuleCourte : null,
        formuleLongue: data.duree === 'longue' ? data.formuleLongue : null,
        packMateriel: data.packMateriel,
        statut: data.statut,
        experience: data.experience,
        specialites: data.specialites,
        certif3ans: data.certif_3ans,
        certifDiplome: data.certif_diplome,
        certifDocs: data.certif_docs,
        cgvAccepted: data.cgv,
        commentaire: data.commentaire || null,
        status: "En attente"
      };

      const dbResponse = await fetch('/api/reservations', {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(reservationData)
      });

      if (!dbResponse.ok) {
        console.error("Database save failed:", await dbResponse.text());
        toast({
          title: "Erreur de sauvegarde",
          description: "Impossible d'enregistrer la r√©servation. Veuillez r√©essayer.",
          variant: "destructive"
        });
        return;
      }

      // STEP 2: Open WhatsApp (Priority Action)
      window.open(whatsappUrl, '_blank');

      // STEP 3: Send emails
        // Email for Manager
        const sendManager = sendEmailWithRetry(
          'service_llizndy', 
          'template_m6uvyuq', 
          { ...templateParams, to_email: "location.phenoandco@gmail.com", to_name: "Manager PHENO&CO" },
          "uBxESnC6CTyqiNyS6"
        ).catch(e => {
          const errInfo = e.text || e.message || JSON.stringify(e);
          console.error("Manager email failed after retries:", errInfo);
          throw new Error(`Manager: ${errInfo}`);
        });
        
        // Email for Client
        const sendClient = sendEmailWithRetry(
          'service_llizndy', 
          'template_m6uvyuq', 
          { ...templateParams, to_email: data.email, to_name: data.nom },
          "uBxESnC6CTyqiNyS6"
        ).catch(e => {
          const errInfo = e.text || e.message || JSON.stringify(e);
          console.error("Client email failed after retries:", errInfo);
          throw new Error(`Client: ${errInfo}`);
        });

        await Promise.all([sendManager, sendClient]);
        setEmailSent(true);
        
        // Auto-hide success message and reset form after 3 seconds
        setTimeout(() => {
          setEmailSent(false);
          form.reset({
            duree: "courte",
            formuleCourte: "heure",
            formuleLongue: "semaine",
            packMateriel: "aucun",
            dateDebut: tomorrowStr,
            dateFin: "",
            heureDebut: "10:00",
            heureFin: "11:00",
            cgv: false,
            statut: "auto",
            experience: "0-3",
            specialites: [],
            certif_3ans: false,
            certif_diplome: false,
            certif_docs: false,
            commentaire: "",
            nom: "",
            email: "",
            telephone: ""
          });
          window.scrollTo({ top: 0, behavior: 'smooth' });
        }, 3000);
        
      } catch (error: any) {
        console.error("Erreur globale email:", error);
        const errorMessage = error?.message || "Erreur inconnue";
        
        // Set explicit error state to show warning in UI
        setEmailError(errorMessage);
        
        // Still show success state because WhatsApp worked
        setEmailSent(true);
        
        // Auto-hide even on email error (since WhatsApp worked)
        setTimeout(() => {
          setEmailSent(false);
          form.reset();
          window.scrollTo({ top: 0, behavior: 'smooth' });
        }, 3000);
        
        toast({
          title: "Attention : Email bloqu√©",
          description: "Votre navigateur a bloqu√© l'envoi de l'email de confirmation, mais la demande WhatsApp a bien √©t√© g√©n√©r√©e.",
          variant: "destructive",
          duration: 8000
        });
      } finally {
        setSending(false);
      }
  };

  const scrollToReservation = () => {
    const element = document.getElementById('reservation');
    if (element) {
      element.scrollIntoView({ behavior: 'smooth' });
    }
  };

  return (
    <div className="min-h-screen bg-background text-foreground font-sans">
      
      {/* HERO SECTION */}
      <section className="bg-black text-white py-12 px-4 md:px-8 flex flex-col items-center justify-center text-center border-b border-white/10">
        <div className="max-w-4xl w-full space-y-0 animate-in fade-in duration-1000 flex flex-col items-center">
          
          {/* Logo Vertical - Adjusted spacing */}
          <div className="mb-0 relative z-10">
             <img src={logoUrl} alt="PHENO&CO Logo" className="w-52 md:w-64 h-auto object-contain mx-auto opacity-90 hover:opacity-100 transition-opacity" />
          </div>

          {/* Titles */}
          <div className="space-y-1 pt-0 relative z-0">
            <h1 className="text-4xl md:text-5xl font-bold tracking-tighter text-[#F9C800] font-serif uppercase leading-tight">
              PHENO&CO
            </h1>
            <p className="text-white text-sm md:text-base tracking-widest uppercase font-medium">
              Barbershop depuis 2009
            </p>
          </div>

          {/* Buttons Grid */}
          <div className="grid grid-cols-1 md:grid-cols-3 gap-4 w-full max-w-3xl mx-auto pt-8">
            <button 
              onClick={scrollToReservation}
              className="w-full py-4 px-6 bg-[#F9C800] hover:bg-[#F9C800]/90 text-black font-bold rounded-xl transition-transform transform hover:-translate-y-1 active:translate-y-0 flex items-center justify-center gap-2 shadow-lg"
            >
              <Calendar className="w-5 h-5" />
              Louer un Fauteuil
            </button>

            <a 
              href="https://phenoandco.com/" 
              target="_blank" 
              rel="noopener noreferrer"
              className="w-full py-4 px-6 bg-[#111827] hover:bg-[#1f2937] text-white border border-gray-700 font-bold rounded-xl transition-transform transform hover:-translate-y-1 active:translate-y-0 flex items-center justify-center gap-2 shadow-lg"
            >
              <Scissors className="w-5 h-5" />
              Prendre RDV Coiffure
            </a>

            <a 
              href="https://wa.me/message/MZYDVEN32I55L1" 
              target="_blank" 
              rel="noopener noreferrer"
              className="w-full py-4 px-6 bg-[#25D366] hover:bg-[#20bd5a] text-white font-bold rounded-xl transition-transform transform hover:-translate-y-1 active:translate-y-0 flex items-center justify-center gap-2 shadow-lg"
            >
              <MessageCircle className="w-5 h-5" />
              Contact WhatsApp
            </a>
          </div>
        </div>
      </section>

      {/* RESERVATION SECTION */}
      <div id="reservation" className="py-12 px-4 md:px-8">
        <div className="max-w-5xl mx-auto">
          
          <header className="text-center mb-10 space-y-4">
            <h2 className="text-3xl md:text-4xl font-serif font-bold text-primary tracking-tight">
              R√©server un fauteuil
            </h2>
            <p className="text-muted-foreground max-w-2xl mx-auto text-base leading-relaxed">
              Choisissez vos dates, votre formule et vos options.<br className="hidden md:block" />
              Vous recevrez un r√©capitulatif et la r√©servation sera confirm√©e apr√®s paiement de l'acompte.
            </p>
          </header>

          <form onSubmit={handleSubmit(onSubmit)} className="grid grid-cols-1 lg:grid-cols-12 gap-8">
            
            {/* Left Column: Configuration */}
            <div className="lg:col-span-7 space-y-8">
              <div className="bg-card border border-card-border rounded-2xl p-6 md:p-8 shadow-xl">
                
                {/* Type Section (MOVED UP) */}
                <div className="flex items-center gap-3 mb-6 pb-4 border-b border-border/50">
                  <Clock className="w-6 h-6 text-primary" />
                  <h2 className="text-xl font-semibold text-foreground">Type de location</h2>
                </div>

                <div className="space-y-6">
                  <div className="space-y-3">
                    <label className="text-sm font-medium text-muted-foreground">Dur√©e de location *</label>
                    <div className="grid grid-cols-1 sm:grid-cols-2 gap-4">
                      <label className={`
                        relative cursor-pointer rounded-xl border p-4 flex items-start gap-3 transition-all duration-200
                        ${values.duree === 'courte' ? 'bg-secondary border-primary/50 ring-1 ring-primary/20' : 'bg-input border-border hover:border-primary/30'}
                      `}>
                        <input type="radio" value="courte" {...register("duree")} className="mt-1 accent-primary w-4 h-4" />
                        <div>
                          <span className="font-semibold block text-foreground">Courte dur√©e</span>
                          <span className="text-xs text-muted-foreground mt-1 block leading-relaxed">Heure, journ√©e<br/>Acompte 50%</span>
                        </div>
                      </label>

                      <label className={`
                        relative cursor-pointer rounded-xl border p-4 flex items-start gap-3 transition-all duration-200
                        ${values.duree === 'longue' ? 'bg-secondary border-primary/50 ring-1 ring-primary/20' : 'bg-input border-border hover:border-primary/30'}
                      `}>
                        <input type="radio" value="longue" {...register("duree")} className="mt-1 accent-primary w-4 h-4" />
                        <div>
                          <span className="font-semibold block text-foreground">Semaine & Mensuel</span>
                          <span className="text-xs text-muted-foreground mt-1 block leading-relaxed">Semaine ou Mois<br/>Acompte 25%</span>
                        </div>
                      </label>
                    </div>
                  </div>

                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div className="space-y-3">
                      <label className="text-sm font-medium text-muted-foreground">
                        {values.duree === 'courte' ? 'Formule courte *' : 'Formule longue *'}
                      </label>
                      {values.duree === 'courte' ? (
                        <select
                          {...register("formuleCourte")}
                          className="w-full bg-input border border-border rounded-lg px-4 py-3 text-foreground focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all appearance-none"
                        >
                          {Object.entries(PRICING.courte).map(([key, val]) => (
                            <option key={key} value={key}>{val.label}</option>
                          ))}
                        </select>
                      ) : (
                        <select
                          {...register("formuleLongue")}
                          className="w-full bg-input border border-border rounded-lg px-4 py-3 text-foreground focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all appearance-none"
                        >
                          <option value="semaine">Semaine ‚Äî 60 ‚Ç¨ HT / jour</option>
                          <option value="mensuel">Mensuel ‚Äî 55 ‚Ç¨ HT / jour</option>
                        </select>
                      )}
                    </div>

                    <div className="space-y-3">
                      <label className="text-sm font-medium text-muted-foreground">Pack Mat√©riel</label>
                      <select
                        {...register("packMateriel")}
                        className="w-full bg-input border border-border rounded-lg px-4 py-3 text-foreground focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all appearance-none"
                      >
                        {Object.entries(PRICING.pack).map(([key, val]) => (
                          <option key={key} value={key}>{val.label}</option>
                        ))}
                      </select>
                    </div>
                  </div>

                  <div className="bg-secondary/30 border border-border rounded-lg p-4 text-sm text-muted-foreground space-y-2">
                    <p><strong className="text-foreground">Pack Essentiel :</strong> 20 ‚Ç¨ HT/jour (tondeuse, finition, serviettes, cape, poste √©quip√©).</p>
                    <p><strong className="text-foreground">Pack Premium :</strong> 30 ‚Ç¨ HT/jour (Essentiel + shaver + serviettes en plus).</p>
                  </div>
                  
                  <div className="bg-yellow-500/10 border border-yellow-500/20 rounded-lg p-4 flex items-start gap-3 text-yellow-500 text-sm">
                    <AlertCircle className="w-5 h-5 shrink-0 mt-0.5" />
                    <p>Les montants calcul√©s sont indicatifs. Le calcul final se fera au prorata selon la grille tarifaire lors de la confirmation.</p>
                  </div>
                </div>

                <div className="my-8 border-t border-border/50"></div>

                {/* Date Section (MOVED DOWN) */}
                <div className="flex items-center gap-3 mb-6 pb-4 border-b border-border/50">
                  <Calendar className="w-6 h-6 text-primary" />
                  <h2 className="text-xl font-semibold text-foreground">Dates & Horaires</h2>
                </div>

                <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                  <div className="space-y-2">
                    <label className="text-sm font-medium text-muted-foreground">Date de d√©but *</label>
                    <input
                      type="date"
                      {...register("dateDebut", { required: true })}
                      min={tomorrowStr}
                      className="w-full bg-input border border-border rounded-lg px-4 py-3 text-foreground focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all [&::-webkit-calendar-picker-indicator]:bg-[#F9C800] [&::-webkit-calendar-picker-indicator]:p-1 [&::-webkit-calendar-picker-indicator]:rounded [&::-webkit-calendar-picker-indicator]:cursor-pointer"
                    />
                  </div>
                  <div className="space-y-2">
                    <label className="text-sm font-medium text-muted-foreground">Date de fin (optionnel)</label>
                    <input
                      type="date"
                      {...register("dateFin")}
                      min={values.dateDebut || tomorrowStr}
                      className="w-full bg-input border border-border rounded-lg px-4 py-3 text-foreground focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all [&::-webkit-calendar-picker-indicator]:bg-[#F9C800] [&::-webkit-calendar-picker-indicator]:p-1 [&::-webkit-calendar-picker-indicator]:rounded [&::-webkit-calendar-picker-indicator]:cursor-pointer"
                    />
                  </div>
                  <div className="space-y-2">
                    <label className="text-sm font-medium text-muted-foreground">Heure de d√©but *</label>
                    <select
                      {...register("heureDebut", { required: true })}
                      disabled={values.duree === 'courte' && values.formuleCourte === 'journee'}
                      className="w-full bg-input border border-border rounded-lg px-4 py-3 text-foreground focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all appearance-none disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                      {availableStartTimes.map(t => <option key={t} value={t}>{t}</option>)}
                    </select>
                  </div>
                  <div className="space-y-2">
                    <label className="text-sm font-medium text-muted-foreground">Heure de fin *</label>
                    <select
                      {...register("heureFin", { required: true })}
                      disabled={values.duree === 'courte' && (values.formuleCourte === 'journee' || values.formuleCourte === 'demi')}
                      className="w-full bg-input border border-border rounded-lg px-4 py-3 text-foreground focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all appearance-none disabled:opacity-50 disabled:cursor-not-allowed"
                    >
                      {availableEndTimes.map(t => <option key={t} value={t}>{t}</option>)}
                    </select>
                  </div>
                </div>
              </div>
            </div>

            {/* Right Column: Summary & User Info */}
            <div className="lg:col-span-5 space-y-8">
              <div className="bg-card border border-card-border rounded-2xl p-6 md:p-8 shadow-xl sticky top-8">
                
                <div className="flex items-center gap-3 mb-6 pb-4 border-b border-border/50">
                  <User className="w-6 h-6 text-primary" />
                  <h2 className="text-xl font-semibold text-foreground">Vos informations</h2>
                </div>

                <div className="space-y-4">
                   {/* A. Bloc identit√© & contact */}
                   <div>
                      <label className="block text-sm font-medium text-muted-foreground mb-1">Nom / pr√©nom *</label>
                      <input
                        type="text"
                        {...register("nom", { required: true })}
                        className="w-full bg-input border border-border rounded-lg px-4 py-3 text-foreground focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all placeholder:text-muted-foreground/50"
                        placeholder="Votre nom"
                      />
                   </div>

                   <div>
                      <label className="block text-sm font-medium text-muted-foreground mb-1">Email *</label>
                      <input
                        type="email"
                        {...register("email", { required: true })}
                        className="w-full bg-input border border-border rounded-lg px-4 py-3 text-foreground focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all placeholder:text-muted-foreground/50"
                        placeholder="votre@email.com"
                      />
                   </div>

                   <div>
                      <label className="block text-sm font-medium text-muted-foreground mb-1">T√©l√©phone / WhatsApp *</label>
                      <input
                        type="tel"
                        {...register("telephone", { required: true })}
                        className="w-full bg-input border border-border rounded-lg px-4 py-3 text-foreground focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all placeholder:text-muted-foreground/50"
                        placeholder="06 00 00 00 00"
                      />
                   </div>

                   <hr className="border-t border-border/50 my-4" />

                   {/* B. Bloc profil professionnel */}
                   <div className="space-y-4">
                      <h3 className="text-md font-semibold text-primary">Profil Professionnel</h3>
                      
                      <div>
                         <label className="block text-sm font-medium text-muted-foreground mb-1">Statut *</label>
                         <div className="flex flex-wrap gap-4">
                            <label className="flex items-center gap-2 cursor-pointer">
                               <input type="radio" value="auto" {...register("statut")} className="accent-primary w-4 h-4" />
                               <span className="text-sm">Auto-entrepreneur / Micro</span>
                            </label>
                            <label className="flex items-center gap-2 cursor-pointer">
                               <input type="radio" value="societe" {...register("statut")} className="accent-primary w-4 h-4" />
                               <span className="text-sm">Soci√©t√©</span>
                            </label>
                            <label className="flex items-center gap-2 cursor-pointer">
                               <input type="radio" value="creation" {...register("statut")} className="accent-primary w-4 h-4" />
                               <span className="text-sm">En cours de cr√©ation</span>
                            </label>
                         </div>
                      </div>

                      <div>
                         <label className="block text-sm font-medium text-muted-foreground mb-1">Exp√©rience *</label>
                         <select
                            {...register("experience")}
                            className="w-full bg-input border border-border rounded-lg px-4 py-3 text-foreground focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all appearance-none"
                         >
                            <option value="0-3">0‚Äì3 ans</option>
                            <option value="3-5">3‚Äì5 ans</option>
                            <option value="5-10">5‚Äì10 ans</option>
                            <option value="10+">10+ ans</option>
                         </select>
                      </div>
                   </div>

                   <hr className="border-t border-border/50 my-4" />

                   {/* C. Bloc type de profil */}
                   <div className="space-y-3">
                      <div className="flex items-center justify-between">
                         <h3 className="text-md font-semibold text-primary">Comp√©tences & Sp√©cialit√©s</h3>
                         <span className="text-xs text-muted-foreground">(Plusieurs choix possibles)</span>
                      </div>
                      
                      <div className="grid grid-cols-1 gap-2">
                         {[
                            "Coiffeur mixte (H/F)", 
                            "Barbier", 
                            "Sp√©cialit√© afro (tresses, locks, vanilles, etc.)", 
                            "Coloriste (m√®ches, balayage, d√©co)", 
                            "Design & finitions (contours, dessins, rasage, etc.)"
                         ].map((spec) => (
                            <label key={spec} className="flex items-center gap-3 cursor-pointer hover:bg-white/5 p-2 rounded transition-colors">
                               <input 
                                  type="checkbox" 
                                  value={spec} 
                                  {...register("specialites")} 
                                  className="accent-primary w-4 h-4"
                               />
                               <span className="text-sm">{spec}</span>
                            </label>
                         ))}
                      </div>
                   </div>

                   <hr className="border-t border-border/50 my-4" />

                   {/* D. Bloc engagement */}
                   <div className="space-y-3 bg-secondary/20 p-4 rounded-xl border border-primary/10">
                      <h3 className="text-md font-semibold text-primary flex items-center gap-2">
                         <Check className="w-4 h-4" /> Engagement
                      </h3>
                      
                      <label className="flex items-start gap-3 cursor-pointer">
                         <input type="checkbox" {...register("certif_3ans")} className="accent-primary w-4 h-4 mt-1" />
                         <span className="text-sm leading-tight">Je certifie avoir au moins 3 ans d'exp√©rience.</span>
                      </label>

                      <label className="flex items-start gap-3 cursor-pointer">
                         <input type="checkbox" {...register("certif_diplome")} className="accent-primary w-4 h-4 mt-1" />
                         <span className="text-sm leading-tight">Je poss√®de (ou suis en cours) un CAP/BP ou dipl√¥me √©quivalent.</span>
                      </label>

                      <label className="flex items-start gap-3 cursor-pointer">
                         <input type="checkbox" {...register("certif_docs", { required: true })} className="accent-primary w-4 h-4 mt-1" />
                         <span className="text-sm leading-tight">Je m'engage √† fournir les documents justificatifs avant le d√©but de la location (envoy√©s par email apr√®s la demande).</span>
                      </label>

                      <label className="flex items-start gap-3 cursor-pointer">
                         <input type="checkbox" {...register("cgv", { required: true })} className="accent-primary w-4 h-4 mt-1" />
                         <span className="text-sm leading-tight">
                            J'ai lu et j'accepte les <a href="/cgv-location" target="_blank" className="text-primary underline hover:text-primary/80">CGV & Contrat de location PHENO&CO</a>.
                         </span>
                      </label>
                   </div>

                </div>

                <div className="mt-6 space-y-2">
                  <label className="text-sm font-medium text-muted-foreground">Commentaire (optionnel)</label>
                  <textarea
                    {...register("commentaire")}
                    placeholder="Pr√©cisez par exemple vos jours de pr√©sence souhait√©s‚Ä¶"
                    className="w-full bg-input border border-border rounded-lg px-4 py-3 text-foreground focus:ring-2 focus:ring-primary/50 focus:border-primary outline-none transition-all min-h-[100px] placeholder:text-muted-foreground/50 resize-y"
                  />
                </div>

                <div className="mt-8 pt-6 border-t border-border/50 space-y-4">
                  <h3 className="text-lg font-semibold text-foreground mb-4 flex items-center gap-2">
                    <Info className="w-5 h-5 text-primary" />
                    R√©capitulatif (indicatif)
                  </h3>
                  
                  <div className="space-y-2 text-sm">
                    <div className="flex justify-between text-muted-foreground">
                      <span>Formule</span>
                      <span className="font-medium text-foreground text-right">{priceInfo.formuleLabel}</span>
                    </div>
                    <div className="flex justify-between text-muted-foreground">
                      <span>Dur√©e</span>
                      <span className="font-medium text-foreground text-right">{priceInfo.durationDetails}</span>
                    </div>
                    {priceInfo.packHT > 0 && (
                      <div className="flex justify-between text-muted-foreground">
                        <span>Pack Mat√©riel</span>
                        <span className="font-medium text-foreground text-right">{priceInfo.packLabel}</span>
                      </div>
                    )}
                    
                    <div className="border-t border-border/50 my-2 pt-2 space-y-1">
                      <div className="flex justify-between text-muted-foreground">
                        <span>Total HT</span>
                        <span className="font-medium text-foreground">{priceInfo.totalHT.toFixed(2)} ‚Ç¨</span>
                      </div>
                      <div className="flex justify-between text-muted-foreground">
                        <span>TVA (20%)</span>
                        <span className="font-medium text-foreground">{priceInfo.tva.toFixed(2)} ‚Ç¨</span>
                      </div>
                      <div className="flex justify-between text-lg font-bold text-primary pt-2">
                        <span>TOTAL TTC</span>
                        <span>{priceInfo.totalTTC.toFixed(2)} ‚Ç¨</span>
                      </div>
                    </div>

                    <div className="bg-primary/10 rounded-lg p-3 mt-4 space-y-1">
                      <div className="flex justify-between text-sm font-medium text-green-400">
                        <span>Acompte √† r√©gler ({(priceInfo.acompteTaux * 100).toFixed(0)}%)</span>
                        <span>{priceInfo.acompteTTC.toFixed(2)} ‚Ç¨</span>
                      </div>
                      <div className="flex justify-between text-xs text-muted-foreground">
                        <span>Solde restant</span>
                        <span>{priceInfo.soldeTTC.toFixed(2)} ‚Ç¨</span>
                      </div>
                    </div>
                  </div>
                </div>

                <div className="mt-6 space-y-4">
                  
                  <button
                    type="submit"
                    disabled={sending || emailSent}
                    className={`
                      w-full py-4 px-6 rounded-xl font-bold text-lg flex items-center justify-center gap-2 transition-all transform hover:-translate-y-1 active:translate-y-0 shadow-lg
                      ${sending || emailSent
                        ? 'bg-muted text-muted-foreground cursor-not-allowed' 
                        : 'bg-primary hover:bg-primary/90 text-black'
                      }
                    `}
                  >
                    {sending ? (
                      <>Envoi en cours...</>
                    ) : emailSent ? (
                      <>
                        <Check className="w-6 h-6" />
                        Demande Envoy√©e !
                      </>
                    ) : (
                      <>
                        Envoyer ma demande
                        <ArrowRight className="w-5 h-5" />
                      </>
                    )}
                  </button>
                </div>

                {/* Success Message Overlay (Simple & Transient) */}
                {emailSent && (
                  <div className="mt-6 p-4 bg-green-500/10 border border-green-500/30 rounded-xl animate-in fade-in slide-in-from-bottom-4">
                    <div className="flex items-center gap-3 mb-2">
                      <Check className="w-5 h-5 text-green-500" />
                      <h4 className="font-bold text-green-500 text-lg">Demande envoy√©e</h4>
                    </div>
                    
                    <p className="text-sm text-gray-300 leading-relaxed">
                      Votre demande a √©t√© envoy√©e.<br/>
                      Un r√©capitulatif vous a √©t√© transmis par WhatsApp / email.
                    </p>

                    {emailError && (
                      <p className="text-xs text-yellow-500 mt-2 flex items-center gap-2">
                        <AlertCircle className="w-3 h-3" />
                        Note: L'email n'a pas pu √™tre envoy√© (bloqueur de pub d√©tect√©), mais WhatsApp a fonctionn√©.
                      </p>
                    )}
                  </div>
                )}

              </div>
            </div>          </form>

          {/* Valeurs PHENO&CO Section */}
          <div className="mt-12 bg-card border border-card-border rounded-2xl p-6 md:p-8 shadow-xl">
            <div className="flex items-center gap-3 mb-4">
               {/* Using a Star or Heart icon might be nice, but keeping Info is safe or maybe Sparkles */}
              <span className="text-2xl">‚ú®</span>
              <h3 className="text-lg font-semibold text-foreground">√Ä propos</h3>
            </div>
            <div className="space-y-4 text-muted-foreground leading-relaxed">
              <p className="font-medium text-foreground">
                PHENO&CO, plus qu'un salon : un espace fond√© sur le respect, la bienveillance et l'exigence.
              </p>
              <p>
                On partage l'√©nergie et la passion du m√©tier.
                Chaque coiffeur arrive avec son histoire, son style et son talent, contribuant √† maintenir une ambiance conviviale et familiale.
              </p>
              <p>
                Que vous soyez de passage ou en longue collaboration, l'essentiel reste le m√™me : passion, s√©rieux et bonne vibe.
              </p>
              <p className="text-primary font-bold pt-2">
                √Ä bient√¥t.
              </p>
            </div>
          </div>

        </div>
      </div>

      {/* FOOTER */}
      <footer className="bg-black py-8 border-t border-white/10 text-center text-muted-foreground text-sm flex flex-col items-center gap-4">
        <p>PHENO&CO ‚Äî Barbershop & Coworking ‚Ä¢ Montpellier</p>
        <a href="/admin-secret.html" className="text-xs opacity-20 hover:opacity-100 transition-opacity">Admin</a>
      </footer>

    </div>
  );
}
